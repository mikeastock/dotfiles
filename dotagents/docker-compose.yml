services:
  agent-status-e2e:
    build:
      context: .
      dockerfile: docker/codex-pi-test/Dockerfile
    environment:
      OPENAI_API_KEY: ${OPENAI_API_KEY:?set OPENAI_API_KEY in your environment}
      PI_PROVIDER: ${PI_PROVIDER:-openai}
      PI_MODEL: ${PI_MODEL:-gpt-4o-mini}
      PI_PROMPT: ${PI_PROMPT:-pi-ok}
      CODEX_PROMPT: ${CODEX_PROMPT:-codex-ok}
      WAIT_SECONDS: ${WAIT_SECONDS:-25}
    volumes:
      - .:/workspace
      - codex_home:/home/dev/.codex
      - pi_home:/home/dev/.pi
    working_dir: /workspace
    command: ["/bin/bash", "/workspace/docker/codex-pi-test/run-e2e.sh"]
    tty: true

volumes:
  codex_home:
  pi_home:
